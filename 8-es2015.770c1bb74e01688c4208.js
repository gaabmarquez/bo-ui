(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"7xCj":function(t,e,n){"use strict";n.r(e),n.d(e,"CanalSmsModule",(function(){return q}));var c=n("6NWb"),i=n("ofXK"),o=n("wHSu"),r=n("XNiG"),s=n("Kj3r"),a=n("fXoL"),l=n("Qhg0"),d=n("tk/3");let g=(()=>{class t{constructor(t){this.http=t}getAllTransactions(t){return this.http.get(`${l.a.configs.baseUrl}/canalsms/segmentedTransactions?${t}`)}downloadReport(t){return this.http.get(`${l.a.configs.baseUrl}/canalsms/segmentedTransactions/export?${t}`,{responseType:"blob"})}}return t.\u0275fac=function(e){return new(e||t)(a.kc(d.c))},t.\u0275prov=a.Sb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=n("AehT"),b=n("3Pt+"),h=n("C4D8"),u=n("1kSV");function p(t,e){1&t&&(a.cc(0,"div",27),a.Xb(1,"div",28),a.bc())}function m(t,e){if(1&t){const t=a.dc();a.cc(0,"fa-icon",29),a.oc("click",(function(){return a.Kc(t),a.rc().clearFilter("transactionId")})),a.bc()}if(2&t){const t=a.rc();a.zc("icon",t.faTimesCircle)}}function M(t,e){if(1&t){const t=a.dc();a.cc(0,"fa-icon",29),a.oc("click",(function(){return a.Kc(t),a.rc().clearFilter("message")})),a.bc()}if(2&t){const t=a.rc();a.zc("icon",t.faTimesCircle)}}function C(t,e){if(1&t){const t=a.dc();a.cc(0,"fa-icon",29),a.oc("click",(function(){return a.Kc(t),a.rc().clearFilter("mobile")})),a.bc()}if(2&t){const t=a.rc();a.zc("icon",t.faTimesCircle)}}function O(t,e){if(1&t){const t=a.dc();a.cc(0,"fa-icon",29),a.oc("click",(function(){return a.Kc(t),a.rc().clearFilter("componentName")})),a.bc()}if(2&t){const t=a.rc();a.zc("icon",t.faTimesCircle)}}function v(t,e){if(1&t){const t=a.dc();a.cc(0,"fa-icon",29),a.oc("click",(function(){return a.Kc(t),a.rc().clearFilter("error")})),a.bc()}if(2&t){const t=a.rc();a.zc("icon",t.faTimesCircle)}}function T(t,e){if(1&t){const t=a.dc();a.cc(0,"fa-icon",29),a.oc("click",(function(){return a.Kc(t),a.rc().clearFilter("associatedTransactionId")})),a.bc()}if(2&t){const t=a.rc();a.zc("icon",t.faTimesCircle)}}function F(t,e){if(1&t&&(a.cc(0,"option",42),a.Uc(1),a.bc()),2&t){const t=e.$implicit;a.zc("ngValue",t),a.Fb(1),a.Wc(" ",t," por p\xe1gina")}}function _(t,e){if(1&t&&(a.cc(0,"tr",43),a.cc(1,"td"),a.Uc(2),a.bc(),a.cc(3,"td"),a.Uc(4),a.bc(),a.cc(5,"td"),a.Uc(6),a.bc(),a.cc(7,"td"),a.Uc(8),a.bc(),a.cc(9,"td"),a.Uc(10),a.bc(),a.cc(11,"td"),a.Uc(12),a.bc(),a.cc(13,"td"),a.Uc(14),a.bc(),a.cc(15,"td"),a.Uc(16),a.bc(),a.bc()),2&t){const t=e.$implicit;a.Fb(2),a.Vc(t.transactionId),a.Fb(2),a.Vc(t.message),a.Fb(2),a.Vc(t.mobile),a.Fb(2),a.Wc("",t.startTime," "),a.Fb(2),a.Wc("",t.endTime," "),a.Fb(2),a.Wc("",t.componentName," "),a.Fb(2),a.Wc("",t.error," "),a.Fb(2),a.Wc("",t.associatedTransactionId," ")}}function P(t,e){if(1&t){const t=a.dc();a.cc(0,"div"),a.cc(1,"div",30),a.cc(2,"select",31),a.oc("ngModelChange",(function(e){return a.Kc(t),a.rc().pageSize=e}))("ngModelChange",(function(){return a.Kc(t),a.rc().refreshTransactions(1)})),a.Sc(3,F,2,2,"option",32),a.bc(),a.bc(),a.cc(4,"div",33),a.cc(5,"div",34),a.cc(6,"div",35),a.cc(7,"div",36),a.cc(8,"table",37),a.cc(9,"thead"),a.cc(10,"tr"),a.cc(11,"th"),a.Uc(12," ID Transacci\xf3n "),a.cc(13,"bo-sort-column",38),a.oc("newOrder",(function(e){return a.Kc(t),a.rc().changeOrder("transactionId",e)})),a.bc(),a.bc(),a.cc(14,"th"),a.Uc(15," Mensaje "),a.cc(16,"bo-sort-column",38),a.oc("newOrder",(function(e){return a.Kc(t),a.rc().changeOrder("message",e)})),a.bc(),a.bc(),a.cc(17,"th"),a.Uc(18," M\xf3vil "),a.cc(19,"bo-sort-column",38),a.oc("newOrder",(function(e){return a.Kc(t),a.rc().changeOrder("mobile",e)})),a.bc(),a.bc(),a.cc(20,"th"),a.Uc(21," Fecha inicio "),a.cc(22,"bo-sort-column",38),a.oc("newOrder",(function(e){return a.Kc(t),a.rc().changeOrder("startTime",e)})),a.bc(),a.bc(),a.cc(23,"th"),a.Uc(24," Fecha fin "),a.cc(25,"bo-sort-column",38),a.oc("newOrder",(function(e){return a.Kc(t),a.rc().changeOrder("endTime",e)})),a.bc(),a.bc(),a.cc(26,"th"),a.Uc(27," Componente "),a.cc(28,"bo-sort-column",38),a.oc("newOrder",(function(e){return a.Kc(t),a.rc().changeOrder("componentName",e)})),a.bc(),a.bc(),a.cc(29,"th"),a.Uc(30," Error "),a.cc(31,"bo-sort-column",38),a.oc("newOrder",(function(e){return a.Kc(t),a.rc().changeOrder("error",e)})),a.bc(),a.bc(),a.cc(32,"th"),a.Uc(33," Id asociado "),a.cc(34,"bo-sort-column",38),a.oc("newOrder",(function(e){return a.Kc(t),a.rc().changeOrder("associatedTransactionId",e)})),a.bc(),a.bc(),a.bc(),a.bc(),a.cc(35,"tbody"),a.Sc(36,_,17,8,"tr",39),a.bc(),a.bc(),a.cc(37,"div",40),a.cc(38,"ngb-pagination",41),a.oc("pageChange",(function(e){return a.Kc(t),a.rc().page=e}))("pageChange",(function(){a.Kc(t);const e=a.rc();return e.refreshTransactions(e.page)})),a.bc(),a.bc(),a.bc(),a.bc(),a.bc(),a.bc(),a.bc()}if(2&t){const t=a.rc();a.Fb(2),a.zc("ngModel",t.pageSize),a.Fb(1),a.zc("ngForOf",t.itemsPerPage),a.Fb(10),a.zc("sortOrder",t.sorting.transactionId),a.Fb(3),a.zc("sortOrder",t.sorting.message),a.Fb(3),a.zc("sortOrder",t.sorting.mobile),a.Fb(3),a.zc("sortOrder",t.sorting.startTime),a.Fb(3),a.zc("sortOrder",t.sorting.endTime),a.Fb(3),a.zc("sortOrder",t.sorting.componentName),a.Fb(3),a.zc("sortOrder",t.sorting.error),a.Fb(3),a.zc("sortOrder",t.sorting.associatedTransactionId),a.Fb(2),a.zc("ngForOf",t.transactions),a.Fb(2),a.zc("collectionSize",t.collectionSize)("page",t.page)("pageSize",t.pageSize)("maxSize",3)("boundaryLinks",!0)}}function z(t,e){1&t&&(a.cc(0,"div",44),a.cc(1,"ngb-alert",45),a.Uc(2," No existen proveedores que coincidan con la b\xfasqueda "),a.bc(),a.bc())}let S=(()=>{class t{constructor(t,e){this.transactionsService=t,this.notifService=e,this.page=1,this.collectionSize=0,this.isLoading=!1,this.itemsPerPage=[10,20,30,40,50],this.pageSize=this.itemsPerPage[2],this.filters={transactionId:void 0,mobile:void 0,componentName:void 0,message:void 0,error:void 0,associatedTransactionId:void 0},this.sorts="",this.sorting={transactionId:void 0,message:void 0,mobile:void 0,startTime:void 0,endTime:void 0,componentName:void 0,error:void 0,associatedTransactionId:void 0},this.statuses=["OK","ERROR","PROCESSING"],this.START_TIME="00:00",this.faFileDownload=o.d,this.faTimesCircle=o.n,this.keyUpFilter=new r.a,this.filterSubscription=this.keyUpFilter.pipe(Object(s.a)(500)).subscribe(t=>{this.page=1,this.getAllTransactions()})}ngOnInit(){const t=new Date;this.today=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`,this.getAllTransactions(),this.fromDateTime=this.START_TIME,this.fromDateEndTime=this.START_TIME,this.toDateTime=this.START_TIME,this.toDateEndTime=this.START_TIME}getAllTransactions(){this.isLoading=!0;let t=this.getQueryParams();this.transactionsService.getAllTransactions(t).subscribe(t=>{this.transactions=t.segmentedTransactions,this.collectionSize=this.transactions.length>=this.pageSize?this.page*this.pageSize+10:this.page*this.pageSize,this.isLoading=!1},t=>{this.transactions=[],this.collectionSize=0,this.isLoading=!1})}getQueryParams(t=!1){const e=(this.page-1)*this.pageSize,n=(this.page-1)*this.pageSize+this.pageSize,c=this.getDateFilter(),i=this.concatFilter();let o=t?"":`from=${e}&to=${n}`;return i.length>0&&(o+="&"+i),this.sorts.length>0&&(o+="&"+this.sorts),c.length>0&&(o+="&"+c),o}getDateFilter(){let t="";return this.fromDate&&(t+="fromStartTime="+this.fromDate.replaceAll("-","")+this.fromDateTime.replace(":","")),this.fromDateEnd&&(t+=(t.length>0?"&":"")+"toStartTime="+this.fromDateEnd.replaceAll("-","")+this.fromDateEndTime.replace(":","")),this.toDate&&(t+=(t.length>0?"&":"")+"fromEndTime="+this.toDate.replaceAll("-","")+this.toDateTime.replace(":","")),this.toDateEnd&&(t+=(t.length>0?"&":"")+"toEndTime="+this.toDateEnd.replaceAll("-","")+this.toDateEndTime.replace(":","")),t}concatFilter(){let t="";for(const e in this.filters)this.filters[e]&&this.filters[e].length>0&&(t+=(t.length>0?"&":"")+`${e}=${this.filters[e]}`);return t}refreshTransactions(t){this.page=t,this.getAllTransactions()}onKeyUpFilter(t){this.keyUpFilter.next(t)}clearFilter(t){for(const e in this.filters)if(e==t){this.filters[e]=void 0;break}this.page=1,this.getAllTransactions()}changeOrder(t,e){this.sorting[t]=e;for(const n in this.sorting)n!=t&&(this.sorting[n]=void 0);e&&(this.sorts=`orderBy=${t}&desc=${"desc"==e}`),this.getAllTransactions()}onSearchDateFilters(){this.getAllTransactions()}onClearFilters(){this.resetDateFilters(),this.resetFilters(),this.getAllTransactions()}resetFilters(){this.filters={transactionId:void 0,mobile:void 0,componentName:void 0,message:void 0,error:void 0,associatedTransactionId:void 0}}resetDateFilters(){this.fromDate=void 0,this.fromDateTime=this.START_TIME,this.fromDateEnd=void 0,this.fromDateEndTime=this.START_TIME,this.toDate=void 0,this.toDateTime=this.START_TIME,this.toDateEnd=void 0,this.toDateEndTime=this.START_TIME}ngOnDestroy(){this.filterSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(a.Wb(g),a.Wb(f.a))},t.\u0275cmp=a.Qb({type:t,selectors:[["bo-transactions"]],decls:54,vars:23,consts:[[1,"container-fluid","ml-3"],[1,"title-container"],[1,"title"],["class","spinner-container",4,"ngIf"],[1,"transactions-container"],[1,"date-filters-container"],[1,"date-filters"],[1,"start-filter"],[1,"compose-date"],["type","date",1,"form-control",3,"ngModel","ngModelChange"],["type","time",3,"ngModel","ngModelChange"],[1,"end-filter"],[1,"d-flex","justify-content-end"],[1,"btn","btn-primary","btn-sm","p-2","mt-2","mr-2",3,"click"],[1,"btn","btn-secondary","btn-sm","p-2","mt-2",3,"click"],[1,"mb-0","mt-4","ml-0","w-100"],[1,"d-flex","justify-content-between"],[1,"filter"],["type","text","placeholder","B\xfasqueda por ID de transacci\xf3n",1,"form-control",3,"ngModel","ngModelChange","keyup"],["class","clear-icon",3,"icon","click",4,"ngIf"],["type","text","placeholder","Mensaje",1,"form-control",3,"ngModel","ngModelChange","keyup"],["type","text","placeholder","Movil",1,"form-control",3,"ngModel","ngModelChange","keyup"],["type","text","placeholder","Componente",1,"form-control",3,"ngModel","ngModelChange","keyup"],["type","text","placeholder","Error",1,"form-control",3,"ngModel","ngModelChange","keyup"],["type","text","placeholder","Id Asociado",1,"form-control",3,"ngModel","ngModelChange","keyup"],[4,"ngIf"],["class","mt-4 w-100",4,"ngIf"],[1,"spinner-container"],[1,"spinner"],[1,"clear-icon",3,"icon","click"],[1,"mb-0","mt-4","d-flex","justify-content-end"],[1,"custom-select",2,"width","auto",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"mb-0","mt-2","ml-0","w-100"],[1,"row"],[1,"col-sm-12"],[1,"table-responsive"],[1,"table","table-bordered","table-hover"],[3,"sortOrder","newOrder"],["class","provider-row",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","p-2"],[3,"collectionSize","page","pageSize","maxSize","boundaryLinks","pageChange"],[3,"ngValue"],[1,"provider-row"],[1,"mt-4","w-100"],["type","info",1,"no-result"]],template:function(t,e){1&t&&(a.cc(0,"div",0),a.cc(1,"div",1),a.cc(2,"h1",2),a.Uc(3,"Canal SMS Segmentos de transacciones "),a.bc(),a.bc(),a.Sc(4,p,2,0,"div",3),a.cc(5,"div",4),a.cc(6,"div",5),a.cc(7,"div",6),a.cc(8,"div",7),a.cc(9,"label"),a.Uc(10,"Rango fecha inicio"),a.bc(),a.cc(11,"div",8),a.cc(12,"input",9),a.oc("ngModelChange",(function(t){return e.fromDate=t})),a.bc(),a.cc(13,"input",10),a.oc("ngModelChange",(function(t){return e.fromDateTime=t})),a.bc(),a.bc(),a.cc(14,"div",8),a.cc(15,"input",9),a.oc("ngModelChange",(function(t){return e.fromDateEnd=t})),a.bc(),a.cc(16,"input",10),a.oc("ngModelChange",(function(t){return e.fromDateEndTime=t})),a.bc(),a.bc(),a.bc(),a.bc(),a.cc(17,"div",6),a.cc(18,"div",11),a.cc(19,"label"),a.Uc(20,"Rango fecha fin"),a.bc(),a.cc(21,"div",8),a.cc(22,"input",9),a.oc("ngModelChange",(function(t){return e.toDate=t})),a.bc(),a.cc(23,"input",10),a.oc("ngModelChange",(function(t){return e.toDateTime=t})),a.bc(),a.bc(),a.cc(24,"div",8),a.cc(25,"input",9),a.oc("ngModelChange",(function(t){return e.toDateEnd=t})),a.bc(),a.cc(26,"input",10),a.oc("ngModelChange",(function(t){return e.toDateEndTime=t})),a.bc(),a.bc(),a.bc(),a.bc(),a.bc(),a.cc(27,"div",12),a.cc(28,"button",13),a.oc("click",(function(){return e.onSearchDateFilters()})),a.Uc(29," Aplicar filtro de fechas "),a.bc(),a.cc(30,"button",14),a.oc("click",(function(){return e.onClearFilters()})),a.Uc(31," Limpiar filtros "),a.bc(),a.bc(),a.cc(32,"div",15),a.cc(33,"div",16),a.cc(34,"div",17),a.cc(35,"input",18),a.oc("ngModelChange",(function(t){return e.filters.transactionId=t}))("keyup",(function(t){return e.onKeyUpFilter(t.target.value)})),a.bc(),a.Sc(36,m,1,1,"fa-icon",19),a.bc(),a.cc(37,"div",17),a.cc(38,"input",20),a.oc("ngModelChange",(function(t){return e.filters.message=t}))("keyup",(function(t){return e.onKeyUpFilter(t.target.value)})),a.bc(),a.Sc(39,M,1,1,"fa-icon",19),a.bc(),a.cc(40,"div",17),a.cc(41,"input",21),a.oc("ngModelChange",(function(t){return e.filters.mobile=t}))("keyup",(function(t){return e.onKeyUpFilter(t.target.value)})),a.bc(),a.Sc(42,C,1,1,"fa-icon",19),a.bc(),a.cc(43,"div",17),a.cc(44,"input",22),a.oc("ngModelChange",(function(t){return e.filters.componentName=t}))("keyup",(function(t){return e.onKeyUpFilter(t.target.value)})),a.bc(),a.Sc(45,O,1,1,"fa-icon",19),a.bc(),a.cc(46,"div",17),a.cc(47,"input",23),a.oc("ngModelChange",(function(t){return e.filters.error=t}))("keyup",(function(t){return e.onKeyUpFilter(t.target.value)})),a.bc(),a.Sc(48,v,1,1,"fa-icon",19),a.bc(),a.cc(49,"div",17),a.cc(50,"input",24),a.oc("ngModelChange",(function(t){return e.filters.associatedTransactionId=t}))("keyup",(function(t){return e.onKeyUpFilter(t.target.value)})),a.bc(),a.Sc(51,T,1,1,"fa-icon",19),a.bc(),a.bc(),a.bc(),a.Sc(52,P,39,16,"div",25),a.Sc(53,z,3,0,"div",26),a.bc(),a.bc()),2&t&&(a.Fb(4),a.zc("ngIf",e.isLoading),a.Fb(8),a.zc("ngModel",e.fromDate),a.Fb(1),a.zc("ngModel",e.fromDateTime),a.Fb(2),a.zc("ngModel",e.fromDateEnd),a.Fb(1),a.zc("ngModel",e.fromDateEndTime),a.Fb(6),a.zc("ngModel",e.toDate),a.Fb(1),a.zc("ngModel",e.toDateTime),a.Fb(2),a.zc("ngModel",e.toDateEnd),a.Fb(1),a.zc("ngModel",e.toDateEndTime),a.Fb(9),a.zc("ngModel",e.filters.transactionId),a.Fb(1),a.zc("ngIf",e.filters.transactionId),a.Fb(2),a.zc("ngModel",e.filters.message),a.Fb(1),a.zc("ngIf",e.filters.message),a.Fb(2),a.zc("ngModel",e.filters.mobile),a.Fb(1),a.zc("ngIf",e.filters.mobile),a.Fb(2),a.zc("ngModel",e.filters.componentName),a.Fb(1),a.zc("ngIf",e.filters.componentName),a.Fb(2),a.zc("ngModel",e.filters.error),a.Fb(1),a.zc("ngIf",e.filters.error),a.Fb(2),a.zc("ngModel",e.filters.associatedTransactionId),a.Fb(1),a.zc("ngIf",e.filters.associatedTransactionId),a.Fb(1),a.zc("ngIf",!e.isLoading&&(null==e.transactions?null:e.transactions.length)>0),a.Fb(1),a.zc("ngIf",0==(null==e.transactions?null:e.transactions.length)&&!e.isLoading))},directives:[i.n,b.b,b.n,b.p,c.a,b.t,i.m,h.a,u.g,b.q,b.v,u.a],styles:["input[_ngcontent-%COMP%], label[_ngcontent-%COMP%], p[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{font-size:14px}h1[_ngcontent-%COMP%]{position:relative;display:inline-block}table[_ngcontent-%COMP%]{text-align:center}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;user-select:none;font-size:14px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:middle}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:13px;padding:12px 8px;max-width:150px;word-break:break-word}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(2), table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(3), table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(4), table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(9), table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(10), table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(11){min-width:90px;max-width:120px}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(7){word-break:normal}.filter[_ngcontent-%COMP%]{width:15%;position:relative}.filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:inline-block}.filter[_ngcontent-%COMP%]   .clear-icon[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:5px;right:20px}.spinner-container[_ngcontent-%COMP%]{top:600px}.action-icon[_ngcontent-%COMP%]{cursor:pointer;margin-right:10px;margin-left:5px;font-size:14px}.action-icon.edit[_ngcontent-%COMP%]:hover{color:#1890ff}.action-icon.delete[_ngcontent-%COMP%]:hover{color:#dc3545}@media (max-width:1440px){.filter[_ngcontent-%COMP%]{width:18%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding:.75rem .5rem!important}}.download[_ngcontent-%COMP%]{font-size:1.5rem;margin-left:20px;position:absolute;top:12px;cursor:pointer}.download[_ngcontent-%COMP%]:hover{color:#1890ff}.date-filters-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.date-filters[_ngcontent-%COMP%]{border-radius:5px;padding:5px 0;width:40%}.date-filters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700}.date-filters[_ngcontent-%COMP%]   .end-filter[_ngcontent-%COMP%], .date-filters[_ngcontent-%COMP%]   .start-filter[_ngcontent-%COMP%]{display:flex;flex-direction:column}.date-filters[_ngcontent-%COMP%]   .end-filter[_ngcontent-%COMP%]   .compose-date[_ngcontent-%COMP%]{justify-content:flex-end}.date-filters[_ngcontent-%COMP%]   .compose-date[_ngcontent-%COMP%]{display:flex;margin:10px 0}.date-filters[_ngcontent-%COMP%]   .compose-date[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(odd){margin-right:10px}  .no-result{margin-left:-15px;margin-top:20px}  .no-result button{display:none}"]}),t})(),y=(()=>{class t{constructor(t){this.http=t}getAllTransactions(t){return this.http.get(`${l.a.configs.baseUrl}/canalsms/transactions?${t}`)}getTransactionById(t){return this.http.get(`${l.a.configs.baseUrl}/canalsms/transactions/${t}`)}downloadReport(t){return this.http.get(`${l.a.configs.baseUrl}/canalsms/transactions/export?${t}`,{responseType:"blob"})}}return t.\u0275fac=function(e){return new(e||t)(a.kc(d.c))},t.\u0275prov=a.Sb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function D(t,e){1&t&&(a.cc(0,"div",28),a.Xb(1,"div",29),a.bc())}function x(t,e){if(1&t){const t=a.dc();a.cc(0,"fa-icon",30),a.oc("click",(function(){return a.Kc(t),a.rc().clearFilter("transactionId")})),a.bc()}if(2&t){const t=a.rc();a.zc("icon",t.faTimesCircle)}}function w(t,e){if(1&t){const t=a.dc();a.cc(0,"fa-icon",30),a.oc("click",(function(){return a.Kc(t),a.rc().clearFilter("mobile")})),a.bc()}if(2&t){const t=a.rc();a.zc("icon",t.faTimesCircle)}}function I(t,e){if(1&t){const t=a.dc();a.cc(0,"fa-icon",30),a.oc("click",(function(){return a.Kc(t),a.rc().clearFilter("serviceName")})),a.bc()}if(2&t){const t=a.rc();a.zc("icon",t.faTimesCircle)}}function E(t,e){if(1&t&&(a.cc(0,"option"),a.Uc(1),a.bc()),2&t){const t=e.$implicit;a.Fb(1),a.Wc(" ",t," ")}}function k(t,e){if(1&t&&(a.cc(0,"option",41),a.Uc(1),a.bc()),2&t){const t=e.$implicit;a.zc("ngValue",t),a.Fb(1),a.Wc(" ",t," por p\xe1gina")}}function U(t,e){if(1&t&&(a.cc(0,"tr",45),a.cc(1,"td"),a.Uc(2),a.bc(),a.cc(3,"td"),a.Uc(4),a.bc(),a.cc(5,"td"),a.Uc(6),a.bc(),a.cc(7,"td"),a.Uc(8),a.bc(),a.cc(9,"td"),a.Uc(10),a.bc(),a.cc(11,"td"),a.Uc(12),a.bc(),a.cc(13,"td"),a.Uc(14),a.bc(),a.cc(15,"td"),a.Uc(16),a.bc(),a.bc()),2&t){const t=e.$implicit;a.Fb(2),a.Vc(t.transactionId),a.Fb(2),a.Vc(t.message),a.Fb(2),a.Vc(t.mobile),a.Fb(2),a.Wc("",t.startTime," "),a.Fb(2),a.Wc("",t.endTime," "),a.Fb(2),a.Wc("",t.serviceName," "),a.Fb(2),a.Wc("",t.status," "),a.Fb(2),a.Wc("",t.description," ")}}function A(t,e){if(1&t){const t=a.dc();a.cc(0,"table",42),a.cc(1,"thead"),a.cc(2,"tr"),a.cc(3,"th"),a.Uc(4," ID Transacci\xf3n "),a.cc(5,"bo-sort-column",43),a.oc("newOrder",(function(e){return a.Kc(t),a.rc(2).changeOrder("transactionId",e)})),a.bc(),a.bc(),a.cc(6,"th"),a.Uc(7," Mensaje "),a.cc(8,"bo-sort-column",43),a.oc("newOrder",(function(e){return a.Kc(t),a.rc(2).changeOrder("message",e)})),a.bc(),a.bc(),a.cc(9,"th"),a.Uc(10," M\xf3vil "),a.cc(11,"bo-sort-column",43),a.oc("newOrder",(function(e){return a.Kc(t),a.rc(2).changeOrder("mobile",e)})),a.bc(),a.bc(),a.cc(12,"th"),a.Uc(13," Fecha inicio "),a.cc(14,"bo-sort-column",43),a.oc("newOrder",(function(e){return a.Kc(t),a.rc(2).changeOrder("startTime",e)})),a.bc(),a.bc(),a.cc(15,"th"),a.Uc(16," Fecha fin "),a.cc(17,"bo-sort-column",43),a.oc("newOrder",(function(e){return a.Kc(t),a.rc(2).changeOrder("endTime",e)})),a.bc(),a.bc(),a.cc(18,"th"),a.Uc(19," Servicio "),a.cc(20,"bo-sort-column",43),a.oc("newOrder",(function(e){return a.Kc(t),a.rc(2).changeOrder("serviceName",e)})),a.bc(),a.bc(),a.cc(21,"th"),a.Uc(22," Estado "),a.cc(23,"bo-sort-column",43),a.oc("newOrder",(function(e){return a.Kc(t),a.rc(2).changeOrder("status",e)})),a.bc(),a.bc(),a.cc(24,"th"),a.Uc(25," Descripci\xf3n "),a.cc(26,"bo-sort-column",43),a.oc("newOrder",(function(e){return a.Kc(t),a.rc(2).changeOrder("description",e)})),a.bc(),a.bc(),a.bc(),a.bc(),a.cc(27,"tbody"),a.Sc(28,U,17,8,"tr",44),a.bc(),a.bc()}if(2&t){const t=a.rc(2);a.Fb(5),a.zc("sortOrder",t.sorting.transactionId),a.Fb(3),a.zc("sortOrder",t.sorting.message),a.Fb(3),a.zc("sortOrder",t.sorting.mobile),a.Fb(3),a.zc("sortOrder",t.sorting.startTime),a.Fb(3),a.zc("sortOrder",t.sorting.endTime),a.Fb(3),a.zc("sortOrder",t.sorting.serviceName),a.Fb(3),a.zc("sortOrder",t.sorting.status),a.Fb(3),a.zc("sortOrder",t.sorting.description),a.Fb(2),a.zc("ngForOf",t.transactions)}}function K(t,e){if(1&t){const t=a.dc();a.cc(0,"div"),a.cc(1,"div",31),a.cc(2,"select",32),a.oc("ngModelChange",(function(e){return a.Kc(t),a.rc().pageSize=e}))("ngModelChange",(function(){return a.Kc(t),a.rc().refreshTransactions(1)})),a.Sc(3,k,2,2,"option",33),a.bc(),a.bc(),a.cc(4,"div",34),a.cc(5,"div",35),a.cc(6,"div",36),a.cc(7,"div",37),a.Sc(8,A,29,9,"table",38),a.cc(9,"div",39),a.cc(10,"ngb-pagination",40),a.oc("pageChange",(function(e){return a.Kc(t),a.rc().page=e}))("pageChange",(function(){a.Kc(t);const e=a.rc();return e.refreshTransactions(e.page)})),a.bc(),a.bc(),a.bc(),a.bc(),a.bc(),a.bc(),a.bc()}if(2&t){const t=a.rc();a.Fb(2),a.zc("ngModel",t.pageSize),a.Fb(1),a.zc("ngForOf",t.itemsPerPage),a.Fb(5),a.zc("ngIf",!t.isLoading&&(null==t.transactions?null:t.transactions.length)>0),a.Fb(2),a.zc("collectionSize",t.collectionSize)("page",t.page)("pageSize",t.pageSize)("maxSize",3)("boundaryLinks",!0)}}function R(t,e){1&t&&(a.cc(0,"div",46),a.cc(1,"ngb-alert",47),a.Uc(2," No existen proveedores que coincidan con la b\xfasqueda "),a.bc(),a.bc())}let $=(()=>{class t{constructor(t,e){this.transactionsService=t,this.notifService=e,this.page=1,this.collectionSize=0,this.isLoading=!1,this.itemsPerPage=[10,20,30,40,50],this.pageSize=this.itemsPerPage[2],this.filters={serviceName:void 0,mobile:void 0,status:"",transactionId:void 0},this.sorts="",this.sorting={transactionId:void 0,status:void 0,startTime:void 0,endTime:void 0,modifiedTime:void 0,mobile:void 0,serviceName:void 0,message:void 0,description:void 0},this.statuses=["OK","ERROR","PROCESSING"],this.START_TIME="00:00",this.faFileDownload=o.d,this.faTimesCircle=o.n,this.keyUpFilter=new r.a,this.filterSubscription=this.keyUpFilter.pipe(Object(s.a)(500)).subscribe(t=>{this.page=1,this.getAllTransactions()})}ngOnInit(){const t=new Date;this.today=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`,this.getAllTransactions(),this.fromDateTime=this.START_TIME,this.fromDateEndTime=this.START_TIME,this.toDateTime=this.START_TIME,this.toDateEndTime=this.START_TIME}getAllTransactions(){if(this.isLoading=!0,this.filters.transactionId&&this.filters.transactionId.length>0)this.transactionsService.getTransactionById(this.filters.transactionId).subscribe(t=>{this.transactions=[t],this.collectionSize=1,this.isLoading=!1},t=>{404!=t.status&&this.notifService.unexpectedErrrorEmitted().next(),this.transactions=[],this.collectionSize=0,this.isLoading=!1});else{let t=this.getQueryParams();this.transactionsService.getAllTransactions(t).subscribe(t=>{this.transactions=t.transactions,this.collectionSize=this.transactions.length>=this.pageSize?this.page*this.pageSize+10:this.page*this.pageSize,this.isLoading=!1},t=>{this.notifService.unexpectedErrrorEmitted().next()})}}getQueryParams(t=!1){const e=(this.page-1)*this.pageSize,n=(this.page-1)*this.pageSize+this.pageSize,c=this.getDateFilter(),i=this.concatFilter();let o=t?"":`from=${e}&to=${n}`;return i.length>0&&(o+="&"+i),this.sorts.length>0&&(o+="&"+this.sorts),c.length>0&&(o+="&"+c),o}getDateFilter(){let t="";return this.fromDate&&(t+="fromStartTime="+this.fromDate.replaceAll("-","")+this.fromDateTime.replace(":","")),this.fromDateEnd&&(t+=(t.length>0?"&":"")+"toStartTime="+this.fromDateEnd.replaceAll("-","")+this.fromDateEndTime.replace(":","")),this.toDate&&(t+=(t.length>0?"&":"")+"fromEndTime="+this.toDate.replaceAll("-","")+this.toDateTime.replace(":","")),this.toDateEnd&&(t+=(t.length>0?"&":"")+"toEndTime="+this.toDateEnd.replaceAll("-","")+this.toDateEndTime.replace(":","")),t}concatFilter(){let t="";for(const e in this.filters)this.filters[e]&&this.filters[e].length>0&&(t+=(t.length>0?"&":"")+`${e}=${this.filters[e]}`);return t}refreshTransactions(t){this.page=t,this.getAllTransactions()}onKeyUpFilter(t){this.keyUpFilter.next(t)}clearFilter(t){for(const e in this.filters)if(e==t){this.filters[e]=void 0;break}this.page=1,this.getAllTransactions()}changeOrder(t,e){this.sorting[t]=e;for(const n in this.sorting)n!=t&&(this.sorting[n]=void 0);e&&(this.sorts=`orderBy=${t}&desc=${"desc"==e}`),this.getAllTransactions()}downloadReport(){let t=this.getQueryParams(!0);this.transactionsService.downloadReport(t).subscribe(t=>{const e=new Date,n=new Blob([t],{type:"application/octet-stream"}),c=window.URL.createObjectURL(n);var i=document.createElement("a");const o=e.getMonth()<10?"0"+(e.getMonth()+1):e.getMonth()+1;i.download=`canalsms_transacciones_${e.getDate()}_${o}_${e.getFullYear()}.xlsx`,i.href=c,i.click(),i.remove()},t=>{416==t.status?this.notifService.notificationEmitted().next(["error","Error al descargar!\xa0No se puede generar el reporte por exceder la cantidad m\xe1xima de registros."]):this.notifService.unexpectedErrrorEmitted().next()})}onSearchDateFilters(){this.getAllTransactions()}onClearFilters(){this.resetDateFilters(),this.resetFilters(),this.getAllTransactions()}resetFilters(){this.filters={serviceName:void 0,mobile:void 0,status:"",transactionId:void 0}}resetDateFilters(){this.fromDate=void 0,this.fromDateTime=this.START_TIME,this.fromDateEnd=void 0,this.fromDateEndTime=this.START_TIME,this.toDate=void 0,this.toDateTime=this.START_TIME,this.toDateEnd=void 0,this.toDateEndTime=this.START_TIME}ngOnDestroy(){this.filterSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(a.Wb(y),a.Wb(f.a))},t.\u0275cmp=a.Qb({type:t,selectors:[["bo-transactions"]],decls:51,vars:20,consts:[[1,"container-fluid","ml-3"],[1,"title-container"],[1,"title"],["placement","right","ngbTooltip","Descargar reporte de transacciones",1,"download",3,"icon","click"],["class","spinner-container",4,"ngIf"],[1,"transactions-container"],[1,"date-filters-container"],[1,"date-filters"],[1,"start-filter"],[1,"compose-date"],["type","date",1,"form-control",3,"ngModel","ngModelChange"],["type","time",3,"ngModel","ngModelChange"],[1,"end-filter"],[1,"d-flex","justify-content-end"],[1,"btn","btn-primary","btn-sm","p-2","mt-2","mr-2",3,"click"],[1,"btn","btn-secondary","btn-sm","p-2","mt-2",3,"click"],[1,"mb-0","mt-4","ml-0","w-100"],[1,"d-flex","justify-content-between"],[1,"filter"],["type","text","placeholder","B\xfasqueda por ID de transacci\xf3n",1,"form-control",3,"ngModel","ngModelChange","keyup"],["class","clear-icon",3,"icon","click",4,"ngIf"],["type","text","placeholder","Movil",1,"form-control",3,"ngModel","ngModelChange","keyup"],["type","text","placeholder","Nombre del servicio",1,"form-control",3,"ngModel","ngModelChange","keyup"],[1,"custom-select","status-select",3,"ngModel","ngModelChange"],["value","","selected",""],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","mt-4 w-100",4,"ngIf"],[1,"spinner-container"],[1,"spinner"],[1,"clear-icon",3,"icon","click"],[1,"mb-0","mt-4","d-flex","justify-content-end"],[1,"custom-select",2,"width","auto",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"mb-0","mt-2","ml-0","w-100"],[1,"row"],[1,"col-sm-12"],[1,"table-responsive"],["class","table table-bordered table-hover",4,"ngIf"],[1,"d-flex","justify-content-center","p-2"],[3,"collectionSize","page","pageSize","maxSize","boundaryLinks","pageChange"],[3,"ngValue"],[1,"table","table-bordered","table-hover"],[3,"sortOrder","newOrder"],["class","provider-row",4,"ngFor","ngForOf"],[1,"provider-row"],[1,"mt-4","w-100"],["type","info",1,"no-result"]],template:function(t,e){1&t&&(a.cc(0,"div",0),a.cc(1,"div",1),a.cc(2,"h1",2),a.Uc(3,"Canal SMS Transacciones "),a.cc(4,"fa-icon",3),a.oc("click",(function(){return e.downloadReport()})),a.bc(),a.bc(),a.bc(),a.Sc(5,D,2,0,"div",4),a.cc(6,"div",5),a.cc(7,"div",6),a.cc(8,"div",7),a.cc(9,"div",8),a.cc(10,"label"),a.Uc(11,"Rango fecha inicio"),a.bc(),a.cc(12,"div",9),a.cc(13,"input",10),a.oc("ngModelChange",(function(t){return e.fromDate=t})),a.bc(),a.cc(14,"input",11),a.oc("ngModelChange",(function(t){return e.fromDateTime=t})),a.bc(),a.bc(),a.cc(15,"div",9),a.cc(16,"input",10),a.oc("ngModelChange",(function(t){return e.fromDateEnd=t})),a.bc(),a.cc(17,"input",11),a.oc("ngModelChange",(function(t){return e.fromDateEndTime=t})),a.bc(),a.bc(),a.bc(),a.bc(),a.cc(18,"div",7),a.cc(19,"div",12),a.cc(20,"label"),a.Uc(21,"Rango fecha fin"),a.bc(),a.cc(22,"div",9),a.cc(23,"input",10),a.oc("ngModelChange",(function(t){return e.toDate=t})),a.bc(),a.cc(24,"input",11),a.oc("ngModelChange",(function(t){return e.toDateTime=t})),a.bc(),a.bc(),a.cc(25,"div",9),a.cc(26,"input",10),a.oc("ngModelChange",(function(t){return e.toDateEnd=t})),a.bc(),a.cc(27,"input",11),a.oc("ngModelChange",(function(t){return e.toDateEndTime=t})),a.bc(),a.bc(),a.bc(),a.bc(),a.bc(),a.cc(28,"div",13),a.cc(29,"button",14),a.oc("click",(function(){return e.onSearchDateFilters()})),a.Uc(30," Aplicar filtro de fechas "),a.bc(),a.cc(31,"button",15),a.oc("click",(function(){return e.onClearFilters()})),a.Uc(32," Limpiar filtros "),a.bc(),a.bc(),a.cc(33,"div",16),a.cc(34,"div",17),a.cc(35,"div",18),a.cc(36,"input",19),a.oc("ngModelChange",(function(t){return e.filters.transactionId=t}))("keyup",(function(t){return e.onKeyUpFilter(t.target.value)})),a.bc(),a.Sc(37,x,1,1,"fa-icon",20),a.bc(),a.cc(38,"div",18),a.cc(39,"input",21),a.oc("ngModelChange",(function(t){return e.filters.mobile=t}))("keyup",(function(t){return e.onKeyUpFilter(t.target.value)})),a.bc(),a.Sc(40,w,1,1,"fa-icon",20),a.bc(),a.cc(41,"div",18),a.cc(42,"input",22),a.oc("ngModelChange",(function(t){return e.filters.serviceName=t}))("keyup",(function(t){return e.onKeyUpFilter(t.target.value)})),a.bc(),a.Sc(43,I,1,1,"fa-icon",20),a.bc(),a.cc(44,"div",18),a.cc(45,"select",23),a.oc("ngModelChange",(function(t){return e.filters.status=t}))("ngModelChange",(function(){return e.refreshTransactions(1)})),a.cc(46,"option",24),a.Uc(47," Seleccione un estado"),a.bc(),a.Sc(48,E,2,1,"option",25),a.bc(),a.bc(),a.bc(),a.bc(),a.Sc(49,K,11,8,"div",26),a.Sc(50,R,3,0,"div",27),a.bc(),a.bc()),2&t&&(a.Fb(4),a.zc("icon",e.faFileDownload),a.Fb(1),a.zc("ngIf",e.isLoading),a.Fb(8),a.zc("ngModel",e.fromDate),a.Fb(1),a.zc("ngModel",e.fromDateTime),a.Fb(2),a.zc("ngModel",e.fromDateEnd),a.Fb(1),a.zc("ngModel",e.fromDateEndTime),a.Fb(6),a.zc("ngModel",e.toDate),a.Fb(1),a.zc("ngModel",e.toDateTime),a.Fb(2),a.zc("ngModel",e.toDateEnd),a.Fb(1),a.zc("ngModel",e.toDateEndTime),a.Fb(9),a.zc("ngModel",e.filters.transactionId),a.Fb(1),a.zc("ngIf",e.filters.transactionId),a.Fb(2),a.zc("ngModel",e.filters.mobile),a.Fb(1),a.zc("ngIf",e.filters.mobile),a.Fb(2),a.zc("ngModel",e.filters.serviceName),a.Fb(1),a.zc("ngIf",e.filters.serviceName),a.Fb(2),a.zc("ngModel",e.filters.status),a.Fb(3),a.zc("ngForOf",e.statuses),a.Fb(1),a.zc("ngIf",!e.isLoading&&(null==e.transactions?null:e.transactions.length)>0),a.Fb(1),a.zc("ngIf",0==(null==e.transactions?null:e.transactions.length)&&!e.isLoading))},directives:[c.a,u.i,i.n,b.b,b.n,b.p,b.t,b.q,b.v,i.m,u.g,h.a,u.a],styles:["input[_ngcontent-%COMP%], label[_ngcontent-%COMP%], p[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{font-size:14px}h1[_ngcontent-%COMP%]{position:relative;display:inline-block}table[_ngcontent-%COMP%]{text-align:center}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;user-select:none;font-size:14px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:middle}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:13px;padding:12px 8px;max-width:150px;word-break:break-word}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(2), table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(3), table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(4), table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(9), table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(10), table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(11){min-width:90px;max-width:120px}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(7){word-break:normal}.filter[_ngcontent-%COMP%]{width:15%;position:relative}.filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:inline-block}.filter[_ngcontent-%COMP%]   .clear-icon[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:5px;right:20px}.spinner-container[_ngcontent-%COMP%]{top:600px}.action-icon[_ngcontent-%COMP%]{cursor:pointer;margin-right:10px;margin-left:5px;font-size:14px}.action-icon.edit[_ngcontent-%COMP%]:hover{color:#1890ff}.action-icon.delete[_ngcontent-%COMP%]:hover{color:#dc3545}@media (max-width:1440px){.filter[_ngcontent-%COMP%]{width:18%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding:.75rem .5rem!important}}.download[_ngcontent-%COMP%]{font-size:1.5rem;margin-left:20px;position:absolute;top:12px;cursor:pointer}.download[_ngcontent-%COMP%]:hover{color:#1890ff}.date-filters-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.date-filters[_ngcontent-%COMP%]{border-radius:5px;padding:5px 0;width:40%}.date-filters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700}.date-filters[_ngcontent-%COMP%]   .end-filter[_ngcontent-%COMP%], .date-filters[_ngcontent-%COMP%]   .start-filter[_ngcontent-%COMP%]{display:flex;flex-direction:column}.date-filters[_ngcontent-%COMP%]   .end-filter[_ngcontent-%COMP%]   .compose-date[_ngcontent-%COMP%]{justify-content:flex-end}.date-filters[_ngcontent-%COMP%]   .compose-date[_ngcontent-%COMP%]{display:flex;margin:10px 0}.date-filters[_ngcontent-%COMP%]   .compose-date[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(odd){margin-right:10px}  .no-result{margin-left:-15px;margin-top:20px}  .no-result button{display:none}"]}),t})();var N=n("tyNb"),L=n("lDT9");const j=[{path:"",pathMatch:"full",redirectTo:"transacciones"},{path:"transacciones",canActivate:[L.a],component:$},{path:"segmentos",canActivate:[L.a],component:S}];let W=(()=>{class t{}return t.\u0275mod=a.Ub({type:t}),t.\u0275inj=a.Tb({factory:function(e){return new(e||t)},imports:[[N.g.forChild(j)],N.g]}),t})();var V=n("PCNd");let q=(()=>{class t{}return t.\u0275mod=a.Ub({type:t}),t.\u0275inj=a.Tb({factory:function(e){return new(e||t)},imports:[[i.c,W,c.b,b.i,b.s,u.h,u.b,u.j,V.a]]}),t})()}}]);